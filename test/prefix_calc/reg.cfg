%{
#include <math.h>
#include <stdio.h>
%}

%token <double> NUM 257
%token ADD 258
%token SUB 259
%token MUL 260
%token DIV 261
%token POW 262
%token NEG 263
%token NL 264

%nterm input
%nterm line
%nterm <double> exp

%start input

%param <void*> state

%%

input:
  | line input
  ;

line: NL
  | exp NL %{printf("\t%.10g\n", $1);%}
  ;

exp: NUM %{$$ = $1;%}
  | ADD exp exp %{$$ = $2 + $3;%}
  | SUB exp exp %{$$ = $2 - $3;%}
  | MUL exp exp %{$$ = $2 * $3;%}
  | DIV exp exp %{$$ = $2 / $3;%}
  | POW exp exp %{$$ = pow($2,$3);%}
  | NEG exp %{$$ = -$2;%}
  ;

%%

extern int yylex(YYSTYPE* lvalp, void* state);
